<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <title>jQ-ui theme gen</title>
        <link type="text/css" href="../s/jq/theme/ui.all.css" rel="Stylesheet" />
        <script type="text/javascript" src="../s/jq/jquery-1.3.1.js"></script>
        <script type="text/javascript" src="../s/jq/jquery-ui-personalized-1.6rc6.js"></script>
        <script type="text/javascript" src="jquery.timer.js"></script>
        <script type="text/javascript">
            function addStyleSheet(rule){
                var el = $('<style type="text/css"></style>').appendTo('head').attr({
                    //media: media,
                    //id:    id,
                    type:  'text/css'
                })[0];
                if(el.styleSheet !== undefined && el.styleSheet.cssText !==
                    undefined) { // IE
                    el.styleSheet.cssText = rule;
                } else {
                    el.appendChild(document.createTextNode(rule)); // Others
                    //el.innerHTML = css;
                };

            };

            function flash() {
                //animate( params, [duration], [easing], [callback] )
                var el = $('div.toggler > div.im-badge:visible').eq(0).find("span.im-feed-name");
                var oldColor = el.css("color");
                el.css({'color' : 'red',"opacity": .5});
                el.animate({"opacity": 1}, 500,null, function(){el.css({'color':oldColor})});
            }
            // map unit name and value-class-suffix
            var iMUnits = {
                w:   {name:"W",    suffix:"w",    format:"0000"},
                kw:  {name:"kW",   suffix:"kw",   format:"0.00"},
                kwhd:{name:"kWh/d",suffix:"kwhd", format:"00.0"}
            };
            var iMi18n = {
                'Live':  {'fr':'Cour'},
                'Hour':  {'fr':'Heure'},
                'Day':   {'fr':'Jour'},
                'Week':  {'fr':'Semn'},
                'Month': {'fr':'Mois'},
                'Year':  {'fr':'Annee'},
                "kWh/d": {'fr':'kWh/j'}
            };
            iM18nLang='en';//'fr';
            function getI18n(lookup) {
                var foundEntry = iMi18n[lookup];
                if (foundEntry) {
                    var foundForLang = foundEntry[iM18nLang];
                    if (foundForLang) return foundForLang;
                }
                return lookup;
            }
            function add6Badges(parentID){
                //addBadge(parentID,'Live', iMUnits.w);
                addBadge(parentID,getI18n('Live'), iMUnits.kw);
                addBadge(parentID,getI18n('Hour'), iMUnits.kw);
                addBadge(parentID,getI18n('Day'),  iMUnits.kwhd);
                addBadge(parentID,getI18n('Week'), iMUnits.kwhd);
                addBadge(parentID,getI18n('Month'),iMUnits.kwhd);
                addBadge(parentID,getI18n('Year'), iMUnits.kwhd);
                // hide all 6 'right parts of the badges''
                $(parentID).find('.im-badge-right').hide();
                $(parentID).find('.im-badge').addClass('ui-state-default ui-corner-all');
                $(parentID).find('.im-badge').hover(
                function() { $(this).addClass('ui-state-hover'); },
                function() { $(this).removeClass('ui-state-hover'); }  );
            }
            function addBadge(parentID,feedName,feedUnits){
                var html = '<div class="im-badge im-feed-'+feedName+'">'+
                    '   <div class="im-badge-left">'+
                    '       <div><span class="im-feed-name">'+feedName+'</span><span class="im-feed-units">'+getI18n(feedUnits.name)+'</span></div>'+
                    '       <div class="im-v-'+feedUnits.suffix+'">'+feedUnits.format+'</div>'+
                    '   </div>'+
                    '   <div class="im-badge-right">'+
                    '       <div class="im-v-percent">+0%</div>'+
                    '       <div class="im-v-overunder">over target</div>'+
                    '   </div>'+
                    '</div>';
                $(parentID).append(html);
                // hiding and decorationg is performed in add6Badges.
            }

            function addBadgeView(parentID,feedName,feedUnits,bg,fg){
                var html = '<div class="im-badge im-feed-'+feedName+'" style="background:'+bg+'; color: #'+fg+'">'+
                    '   <div class="im-badge-left">'+
                    '       <div><span class="im-feed-name">'+feedName+'</span><span class="im-feed-units">'+getI18n(feedUnits.name)+'</span></div>'+
                    '       <div class="im-v-'+feedUnits.suffix+'">'+feedUnits.format+'</div>'+
                    '   </div>'+
                    '   <div class="im-badge-right">'+
                    '       <div class="im-v-percent">+0%</div>'+
                    '       <div class="im-v-overunder">over target</div>'+
                    '   </div>'+
                    '</div>';
                $(parentID).append(html);
                // hiding and decorationg is performed in add6Badges.
                $(parentID).find('.im-badge-right').hide();
                $(parentID).find('.im-badge').addClass('ui-state-default ui-corner-all');
                $(parentID).find('.im-badge').hover(
                function() { $(this).addClass('ui-state-hover'); },
                function() { $(this).removeClass('ui-state-hover'); }  );

            }
            accumulatebgurls={};
            function accumulateUrlForTheme(theme,color,url){
                var name="im-"+theme+"-"+color+".png"
                accumulatebgurls[name]=url;
            }
            function flat(color) {
                return "#"+color;
            }
            function glass(color) {
                var url='http://jqueryui.com/themeroller/images/?new='+color+'&w=1&h=400&f=png&q=100&fltr[]=over|textures/02_glass.png|0|0|50';
                var bg = '#'+color+' url('+url+') 50% 50% repeat-x';
                accumulateUrlForTheme("glass",color,url);
                return bg;
            }
            function gloss(color) {
                var url = 'http://jqueryui.com/themeroller/images/?new='+color+'&w=500&h=100&f=png&q=100&fltr[]=over|textures/12_gloss_wave.png|0|0|85';
                var bg = '#'+color+' url('+url+') 50% 50% repeat-x';
                accumulateUrlForTheme("gloss",color,url);
                return bg;
            }
            function hsoft(color) {
                var url = 'http://jqueryui.com/themeroller/images/?new='+color+'&w=1&h=100&f=png&q=100&fltr[]=over|textures/03_highlight_soft.png|0|0|75';
                var bg = '#'+color+' url('+url+') 50% 50% repeat-x';
                accumulateUrlForTheme("hsoft",color,url);
                return bg;
            }
            $(function(){

                var themes = [
                    {name:'green',  dbg:'006600', dfg:'ffffff', hbg:'009900', hfg:'ffffff'},
                    {name:'greend', dbg:'006600', dfg:'ffffff', hbg:'009900', hfg:'000000'},
                    {name:'blue',   dbg:'3b5598', dfg:'ffffff', hbg:'7f93bc', hfg:'ffffff'},
                    {name:'blued',  dbg:'3b5598', dfg:'ffffff', hbg:'7f93bc', hfg:'000000'},
                    {name:'black',  dbg:'000000', dfg:'ffffff', hbg:'444444', hfg:'b8ec79'}
                ];
                 var variants = [
                    {name:'flat',  ffunc: flat  },
                    {name:'glass', ffunc: glass },
                    {name:'gloss', ffunc: gloss },
                    {name:'hsoft', ffunc: hsoft }
                ];
               $.each( themes, function() {
                    var theme=this;
                    //alert("p: "+p)
                    $('#colors').append('<div style="">'+
                        '  <div class="button" style="border: 1px solid red; background: #'+theme.dbg+'">'+theme.dbg+'</div>'+
                        '  <div class="button" style="border: 1px solid red; background: #'+theme.dbg+'">'+theme.fbg+'</div>'+
                        '</div>');
                    $.each([flat,glass,gloss,hsoft],function(){
                        var ffunc = this;
                        addBadgeView('#sixBrelative','Day',  iMUnits.kwhd,ffunc(theme.dbg), theme.dfg);
                        addBadgeView('#sixBrelative','Day',  iMUnits.kwhd,ffunc(theme.hbg), theme.hfg);
                    });
                    $('#sixBrelative').append('<div style="clear:both"/>');
                });
                // 2- Wite and Use the themes
                $.each( themes, function() {
                    var theme=this;
                    $.each(variants,function(){
                        var variant = this;
                        var defltsels=['.ui-state-default','.ui-widget-content .ui-state-default'];
                        var hoversels=[
                            '.ui-state-hover',
                            '.ui-widget-content .ui-state-hover',
                            '.ui-state-focus',
                            '.ui-widget-content .ui-state-focus'
                        ];
                        var cssClass='im-lf-'+theme.name+'-'+variant.name;

                        var qualifieddefltsels=[];
                        $.each(defltsels,function(){
                            qualifieddefltsels.push('.'+cssClass+' '+this);
                        });
                        var qualifiedhoversels=[];
                        $.each(hoversels,function(){
                            qualifiedhoversels.push('.'+cssClass+' '+this);
                        });
                        var cssRule = '\n\n/* css class rules for: '+cssClass+' */\n'+
                            qualifieddefltsels.join(', ')+' {\n'+
                            '  background: '+variant.ffunc(theme.dbg)+';\n'+
                            '  color: #'+theme.dfg+'; \n'+
                            '}\n'+
                            qualifiedhoversels.join(', ')+' {\n'+
                            '  background: '+variant.ffunc(theme.hbg)+';\n'+
                            '  color: #'+theme.hfg+'; \n'+
                            '}\n';

                        $('#css-text').append(cssRule);
                        addStyleSheet(cssRule);

                        var sixb = '<h2 class="demoHeaders">Test for: '+cssClass+'</h2>'+
                            '<div style="font-size:100%;">'+
                            '  <div id="test-'+cssClass+'"class="'+cssClass+'"></div>'+
                            '</div>';
                        $('#allSixes').append(sixb);
                        add6Badges('#test-'+cssClass);
                        $('#allSixes').append('<div style="clear:both"/>');


                    });
                });

                $.each(accumulatebgurls,function(name,url){
                    url = url.replace('[','\\[');
                    url = url.replace(']','\\]');
                    $('#wget-text').append('curl -o not/'+name+' "'+url+'";\n');

                });
                // make all badges expand-right on click
                $('.im-badge').click(function() {
                    $(this).find('.im-badge-right').toggle('slide');
                } );

                //  timers
                $.timer(10000, function (timer) {
                    flash();
                });

                //alert("css: "+$(".im-lf-green-flat").css("color"));
                //alert("attr:style: "+$("#test-im-lf-green-flat").attr("style"));
                //$("#test-im-lf-green-flat").attr("style");
                //alert("attr:class: "+$("#test-im-lf-green-flat").attr("class"));

            });
        </script>
        <style type="text/css">
            body { font-family: 'trebuchet ms', verdana, arial; }
            /*body {
                bbackground: url("http://www.imetrical.com/iMetrical/Home_files/shapeimage_1.png") /*50% 50% no-repeat*/;
            }*/

            /* button badges */
            div { margin: 0; padding: 0 }

            div.im-badge {
                float:left;
                width:auto;  height:3em;
                text-align:center;

                padding: 0.3em;
                margin: 0.05em; /* inter box spacing */
            }
            div.im-badge-left {
                float:left;
                width:3.5em;
            }
            div.im-v-w, div.im-v-kw, div.im-v-kwhd {
                clear:both;
                /* vertical offset between floating feed name/units and Value*/
                padding-top:0.3em;
            }
            span.im-feed-name {
                float:left;
                font-size:60%; /*smaller*/
            }
            span.im-feed-units {
                float:right;
                height:1em;
                font-size:50%;
                padding-top:0.2em;
            }
            div.im-badge-right {
                float:right;
                width:4.2em;
            }
            div.im-v-percent {
                /* vertical offset for percent Value*/
                padding-top:0.6em;
            }
            div.im-v-overunder {
                font-size:50%;
            }
            .button {
                float: left;
                width: 5em;
                height: 2em;
                margin:.2em;
            }
        </style>
    </head>
    <body>

        <div id="colors"></div>
        <div style="clear:both"/>

        <h2 class="demoHeaders">Animated badge</h2>
        <div id="scaleTheFont" style="font-size:150%;">
            <div id="sixBrelative" class="toggler" style="background: none; border:0;">
            </div>
        </div>
        <div id="allSixes" ></div>
        <pre id="css-text"></pre>
        <pre id="wget-text"></pre>

    </body>
</html>


