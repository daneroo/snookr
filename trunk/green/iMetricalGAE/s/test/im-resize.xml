<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
<!-- removed height="140" width="240" -->
    <ModulePrefs title="iM-size-test"
     scrolling="false"
     description="iMetrical Resize Test"
     author="Daneroo" author_email="daniel.nojunk@gmail.com">
        <Require feature="dynamic-height"/>
        <Require feature="views"/>
    </ModulePrefs>
    <UserPref name="refreshInterval" display_name="Refresh Interval" default_value="10"/>
    <Content type="html" view="canvas,home">
<![CDATA[ 
        <!-- other bases: http://imetrical.appspot.com/s
                          http://snookr.googlecode.com/svn/trunk/green/iMetricalGAE/s
        -->
        <link type="text/css" href="http://imetrical.appspot.com/s/css/imetrical.all.css" rel="Stylesheet" />
        <script type="text/javascript" src="http://imetrical.appspot.com/s/jq/jquery-1.3.1.js"></script>
        <script type="text/javascript" src="http://imetrical.appspot.com/s/jq/jquery-ui-personalized-1.6rc6.js"></script>
        <script type="text/javascript" src="http://imetrical.appspot.com/s/js/jquery.timer.js"></script>
        <script type="text/javascript" src="http://imetrical.appspot.com/s/js/imetrical-1.0.js"></script>
        <script type="text/javascript">
            var prefs = null;
            try { prefs = new _IG_Prefs(__MODULE_ID__); } catch(err) {}
            var getRefreshIntervalMS = function() {
                var refreshInterval = 5;
                if (prefs) refreshInterval = prefs.getString("refreshInterval");
                return refreshInterval*1000; // every n seconds
            };

            function adjHeight() {
                try { _IG_AdjustIFrameHeight(); } catch(err) {}
            }
            function navigateTo(dest) {
                var supported_views = gadgets.views.getSupportedViews();
                gadgets.views.requestNavigateTo(supported_views[dest]);
            }
            function getViewName() {
                return gadgets.views.getCurrentView().getName();
            }
            function toggleProfileView() {
                if (getViewName() == "canvas") {
                    navigateTo("home");
                } else {
                    navigateTo("canvas");
                }
            }
            $(function(){
                btnarr='';
                btnarr+='<span class="sbtn horz grow" href="#">H+</span>';
                btnarr+='<span class="sbtn horz shrink" href="#">H-</span>';
                btnarr+='<span class="sbtn vert grow" href="#">V+</span>';
                btnarr+='<span class="sbtn vert shrink" href="#">V-</span>';
                btnarr+='<span class="info">Info</span>';
                btnarr+='<div class="rsz">.</div>';
                $(".sizeControl").html(btnarr);

                $("#maxButton").click(toggleProfileView);

                $(".sbtn").click(function () {
                    var par = $(this).parent();
                    var rsz = par.find(".rsz");
                    var incr=0;
                    if ($(this).hasClass("grow")) {
                        incr=30
                    }
                    if ($(this).hasClass("shrink")) {
                        incr=-30
                    }
                    if ($(this).hasClass("vert")) {
                        var h = rsz.height();
                        rsz.height(h+incr);
                    }
                    if ($(this).hasClass("horz")) {
                        var w = rsz.width();
                        rsz.width(w+incr);
                    }

                    if (getViewName() == "canvas") {
                        $("#maxButton").html("-");
                    } else {
                        $("#maxButton").html("+");
                    }
                    adjHeight();

                    var info=""+rsz.width()+"X"+rsz.height();
                    par.find(".info").html(info);

                    iM18nLang='en';
                    add6Badges('#badges');
                    //  animation
                    startAnimNow(4000, function (timer) {
                        storyboardNextAndRollTheme();
                        //storyboardNext();
                    });
                    // fetching timer
                    startAnimNow(getRefreshIntervalMS(), function (timer) {
                        flashInjector();
                        fetchAndMapFeeds(null,null); // url,myInjector
                    });

                });

                function showWinSize(){
                    var info=""+$(window).width()+"X"+$(window).height();
                    $("#topfull").html("Full Box win: "+info);
                    adjHeight();
                }
                $(window).bind('resize',showWinSize);
                showWinSize();
            });
        </script>
        <style type="text/css">
            /* Here be dragons: customize the css */
            .sbtn { width:30px; text-align:center; background:green; padding:5px}
            .rsz {width:60px; height:60px; background:blue}
            body { padding:0; margin:0; }
        </style>

        <div id="maxButton" style="float: right; background:#cccccc; width:2em; height:2em;">*</div>
        <div id="topfull" style="margin:0px; background:#ccffcc;">
            BOX full width
        </div>
        <div class="sizeControl" style="margin:0px; background:#ccffcc;">
        </div>
   <div>
        <div id="scaleTheFont" style="font-size:100%">
            <div id="badges" class="toggler im-lf-black-gloss" style="background: none; border:0;">
            </div>
        </div>
        <div style="clear:both;"></div>
        <div id="chart"></div>
        <div id="status" style="font-size:smaller; color:gray;">G</div>
        <div id="error" style="font-size:smaller; color:red;">R</div>
   </div>

]]> 
    </Content>

</Module>
